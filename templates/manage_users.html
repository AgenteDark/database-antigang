{% extends "base.html" %}

{% block title %}Gestione Utenti - Database AntiGang{% endblock %}

{% block content %}
<div style="padding: 30px;">
    <h2>Gestione Utenti Registrati</h2>
    <table class="table table-bordered table-striped" style="margin-top: 20px;">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Data Registrazione</th>
                <th>Approvato</th>
                <th>Ruolo</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
            {% for utente in utenti %}
            <tr>
                <td>{{ utente[0] }}</td>
                <td>{{ utente[1] }}</td>
                <td>{{ utente[2] }}</td>
                <td>
                    {% if utente[3] == 1 %}
                        ✅ Approvato
                    {% else %}
                        ❌ Non approvato
                    {% endif %}
                </td>
                <td>{{ utente[4] }}</td>
                <td>
                    {% if utente[3] == 0 %}
                        <a href="{{ url_for('approve_user', user_id=utente[0]) }}" class="btn btn-success btn-sm">✔️ Approva</a>
                    {% endif %}
                    
                    {% if utente[4] == 'user' %}
                        <a href="{{ url_for('promote_user', user_id=utente[0]) }}" class="btn btn-primary btn-sm">⬆️ Promuovi a Admin</a>
                    {% elif utente[4] == 'admin' %}
                        <a href="{{ url_for('demote_user', user_id=utente[0]) }}" class="btn btn-warning btn-sm">⬇️ Degrada a User</a>
                    {% endif %}
                    
                    <a href="{{ url_for('delete_user', user_id=utente[0]) }}" 
                       class="btn btn-danger btn-sm"
                       onclick="return confirm('Sei sicuro di voler eliminare questo utente?');">❌ Elimina</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
