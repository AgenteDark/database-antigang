{% extends "base.html" %}

{% block title %}Gestione Utenti - Database Antigang{% endblock %}

{% block content %}
<div style="padding: 40px;">
    <h2 style="text-align: center;">Gestione Utenti</h2>

    <table style="width: 100%; margin-top: 20px; border-collapse: collapse;">
        <thead>
            <tr style="background-color: #007bff; color: white;">
                <th style="padding: 10px;">Username</th>
                <th style="padding: 10px;">Data Registrazione</th>
                <th style="padding: 10px;">Approvato</th>
                <th style="padding: 10px;">Ruolo</th>
                <th style="padding: 10px;">Azioni</th>
            </tr>
        </thead>
        <tbody>
            {% for id, username, data_registrazione, approvato, ruolo in utenti %}
            <tr style="text-align: center; border-bottom: 1px solid #ddd;">
                <td style="padding: 10px;">{{ username }}</td>
                <td style="padding: 10px;">{{ data_registrazione }}</td>
                <td style="padding: 10px;">{{ '✔️' if approvato else '❌' }}</td>
                <td style="padding: 10px;">{{ ruolo }}</td>
                <td style="padding: 10px;">
                    {% if not approvato %}
                        <a href="{{ url_for('approve_user', user_id=id) }}" style="background-color: #28a745; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none; margin-right: 5px;">✅ Approva</a>
                    {% endif %}
                    <a href="{{ url_for('delete_user', user_id=id) }}" onclick="return confirm('Sei sicuro di voler eliminare questo utente?');" style="background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none; margin-right: 5px;">🗑️ Elimina</a>
                    
                    {% if ruolo == 'user' %}
                        <a href="{{ url_for('promote_user', user_id=id) }}" style="background-color: #ffc107; color: black; padding: 5px 10px; border-radius: 5px; text-decoration: none;">🚀 Promuovi a Admin</a>
                    {% elif ruolo == 'admin' %}
                        <a href="{{ url_for('demote_user', user_id=id) }}" style="background-color: #6c757d; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none;">⬇️ Retrocedi a User</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="text-align: center; margin-top: 30px;">
        <a href="{{ url_for('dashboard') }}" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">🏠 Torna alla Dashboard</a>
    </div>
</div>
{% endblock %}
